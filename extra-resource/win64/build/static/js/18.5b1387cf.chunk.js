(this["webpackJsonp@rclone/rclone-webui-react"]=this["webpackJsonp@rclone/rclone-webui-react"]||[]).push([[18],{356:function(e,t,a){"use strict";var n=a(6),r=a(12),i=a(0),o=a.n(i),s=a(4),c=a.n(s),l=a(37),u=a.n(l),d=a(29),p={tag:d.q,inverse:c.a.bool,color:c.a.string,body:c.a.bool,outline:c.a.bool,className:c.a.string,cssModule:c.a.object,innerRef:c.a.oneOfType([c.a.object,c.a.string,c.a.func])},m=function(e){var t=e.className,a=e.cssModule,i=e.color,s=e.body,c=e.inverse,l=e.outline,p=e.tag,m=e.innerRef,f=Object(r.a)(e,["className","cssModule","color","body","inverse","outline","tag","innerRef"]),v=Object(d.m)(u()(t,"card",!!c&&"text-white",!!s&&"card-body",!!i&&(l?"border":"bg")+"-"+i),a);return o.a.createElement(p,Object(n.a)({},f,{className:v,ref:m}))};m.propTypes=p,m.defaultProps={tag:"div"},t.a=m},357:function(e,t,a){"use strict";var n=a(6),r=a(12),i=a(0),o=a.n(i),s=a(4),c=a.n(s),l=a(37),u=a.n(l),d=a(29),p={tag:d.q,className:c.a.string,cssModule:c.a.object,innerRef:c.a.oneOfType([c.a.object,c.a.string,c.a.func])},m=function(e){var t=e.className,a=e.cssModule,i=e.innerRef,s=e.tag,c=Object(r.a)(e,["className","cssModule","innerRef","tag"]),l=Object(d.m)(u()(t,"card-body"),a);return o.a.createElement(s,Object(n.a)({},c,{className:l,ref:i}))};m.propTypes=p,m.defaultProps={tag:"div"},t.a=m},364:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return o}));var n=a(3),r=a(334),i=function(){return function(e){Object(r.getAllProviders)().then((function(t){return e({type:n.y,payload:t.providers})}))}},o=function(){return function(e){Object(r.getAllConfigDump)().then((function(t){return e({type:n.u,status:n.L,payload:t})}),(function(t){return e({type:n.u,status:n.J,payload:t})}))}}},399:function(e,t,a){"use strict";var n=a(31),r=a(32),i=a(110),o=a(68),s=a(67),c=a(0),l=a.n(c),u=a(833),d=a(823),p=a(824),m=a(825),f=a(360),v=a(108),h=function(e){Object(o.a)(a,e);var t=Object(s.a)(a);function a(e){var r;return Object(n.a)(this,a),(r=t.call(this,e)).toggle=r.toggle.bind(Object(i.a)(r)),r}return Object(r.a)(a,[{key:"toggle",value:function(){this.props.closeModal()}},{key:"render",value:function(){var e=this.props.isVisible;return l.a.createElement("div",null,l.a.createElement(v.a,null,l.a.createElement(u.a,{isOpen:e,toggle:this.toggle},l.a.createElement(d.a,{toggle:this.toggle,"data-test":"modalHeader"},"Configuring your drive."),l.a.createElement(p.a,{"data-test":"modalBody"},"A page will open for you with the authentication for your drive. This modal will automatically dismiss upon successful creation"),l.a.createElement(m.a,{"data-test":"modalFooter"},l.a.createElement(f.a,{color:"primary",onClick:this.toggle},"Done")," "))))}}]),a}(l.a.Component);h.defaultProps={isVisible:!0},t.a=h},401:function(e,t,a){"use strict";var n=a(6),r=a(12),i=a(0),o=a.n(i),s=a(4),c=a.n(s),l=a(37),u=a.n(l),d=a(29),p={children:c.a.node,tag:d.q,className:c.a.string,cssModule:c.a.object,valid:c.a.bool,tooltip:c.a.bool},m={tag:"div",valid:void 0},f=function(e){var t=e.className,a=e.cssModule,i=e.valid,s=e.tooltip,c=e.tag,l=Object(r.a)(e,["className","cssModule","valid","tooltip","tag"]),p=s?"tooltip":"feedback",m=Object(d.m)(u()(t,i?"valid-"+p:"invalid-"+p),a);return o.a.createElement(c,Object(n.a)({},l,{className:m}))};f.propTypes=p,f.defaultProps=m,t.a=f},667:function(e,t,a){"use strict";var n,r=a(6),i=a(12),o=a(322),s=a(22),c=a(109),l=a(0),u=a.n(l),d=a(4),p=a.n(d),m=a(37),f=a.n(m),v=a(372),h=a(29);function g(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function b(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?g(Object(a),!0).forEach((function(t){Object(c.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var E=b(b({},v.Transition.propTypes),{},{isOpen:p.a.bool,children:p.a.oneOfType([p.a.arrayOf(p.a.node),p.a.node]),tag:h.q,className:p.a.node,navbar:p.a.bool,cssModule:p.a.object,innerRef:p.a.oneOfType([p.a.func,p.a.string,p.a.object])}),O=b(b({},v.Transition.defaultProps),{},{isOpen:!1,appear:!1,enter:!0,exit:!0,tag:"div",timeout:h.e.Collapse}),y=((n={})[h.d.ENTERING]="collapsing",n[h.d.ENTERED]="collapse show",n[h.d.EXITING]="collapsing",n[h.d.EXITED]="collapse",n);function j(e){return e.scrollHeight}var N=function(e){function t(t){var a;return(a=e.call(this,t)||this).state={height:null},["onEntering","onEntered","onExit","onExiting","onExited"].forEach((function(e){a[e]=a[e].bind(Object(o.a)(a))})),a}Object(s.a)(t,e);var a=t.prototype;return a.onEntering=function(e,t){this.setState({height:j(e)}),this.props.onEntering(e,t)},a.onEntered=function(e,t){this.setState({height:null}),this.props.onEntered(e,t)},a.onExit=function(e){this.setState({height:j(e)}),this.props.onExit(e)},a.onExiting=function(e){e.offsetHeight;this.setState({height:0}),this.props.onExiting(e)},a.onExited=function(e){this.setState({height:null}),this.props.onExited(e)},a.render=function(){var e=this,t=this.props,a=t.tag,n=t.isOpen,o=t.className,s=t.navbar,c=t.cssModule,l=t.children,d=(t.innerRef,Object(i.a)(t,["tag","isOpen","className","navbar","cssModule","children","innerRef"])),p=this.state.height,m=Object(h.o)(d,h.c),g=Object(h.n)(d,h.c);return u.a.createElement(v.Transition,Object(r.a)({},m,{in:n,onEntering:this.onEntering,onEntered:this.onEntered,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}),(function(t){var n=function(e){return y[e]||"collapse"}(t),i=Object(h.m)(f()(o,n,s&&"navbar-collapse"),c),d=null===p?null:{height:p};return u.a.createElement(a,Object(r.a)({},g,{style:b(b({},g.style),d),className:i,ref:e.props.innerRef}),l)}))},t}(l.Component);N.propTypes=E,N.defaultProps=O,t.a=N},832:function(e,t,a){"use strict";a.r(t);var n=a(326),r=a(86),i=a.n(r),o=a(111),s=a(1),c=a(9),l=a(31),u=a(32),d=a(110),p=a(68),m=a(67),f=a(0),v=a.n(f),h=a(456),g=a(457),b=a(50),E=a(350),O=a(401),y=a(318),j=a(83),N=a(360),S=a(667),k=a(356),x=a(357),C=a(399),w=a(85),V=a(84),P=a(379),I=a.n(P),T=function(e,t){var a=t.trim().toLowerCase(),n=a.length;return 0===n?e:0===n?[]:e.filter((function(e){return e.Description.toLowerCase().slice(0,n)===a}))},M=function(e){return e.Prefix},A=function(e){return v.a.createElement("div",null,e.Description)},D=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).onSuggestionsFetchRequested=function(e){var t=e.value;n.setState({suggestions:T(n.props.suggestions,t)})},n.onSuggestionsClearRequested=function(){n.setState({suggestions:[]})},n.state={suggestions:[]},n}return Object(u.a)(a,[{key:"render",value:function(){var e=this.props,t=e.value,a=e.onChange,n=e.suggestions,r=Object(V.f)(n,t),i={placeholder:"Type a provider type",value:void 0===r?t:r.Description,onChange:a};return v.a.createElement(I.a,{suggestions:this.state.suggestions,onSuggestionsFetchRequested:this.onSuggestionsFetchRequested,onSuggestionsClearRequested:this.onSuggestionsClearRequested,getSuggestionValue:M,renderSuggestion:A,alwaysRenderSuggestions:!0,highlightFirstSuggestion:!0,inputProps:i})}}]),a}(v.a.Component),R=a(39),q=a(364),F=a(107),H=a(38),G=a(108),J=a(51);function L(e){var t=e.drivePrefix,a=e.loadAdvanced,n=e.changeHandler,r=e.currentValues,i=e.isValidMap,o=e.errorsMap,s=e.config;if(void 0!==t&&""!==t){var c=Object(V.f)(s,t),l=[];if(void 0!==c)l=c.Options.map((function(e,t){if(0===e.Hide&&(a&&e.Advanced||!a&&!e.Advanced)){var s="".concat(e.Help),c=e.Required?v.a.createElement("i",{className:"text-red"},"*"):null,l=!Object(V.j)(e.Examples),u=null,d="";return e.IsPassword?d="password":l?d="string":"bool"===e.Type?(d="select",u=[v.a.createElement("option",{key:1,value:!0},"Yes"),v.a.createElement("option",{key:2,value:!1},"No")]):d="int"===e.Type?"number":(e.Type,"text"),v.a.createElement(h.a,{key:t,row:!0},v.a.createElement(g.a,{for:e.Name,sm:5},s,c),v.a.createElement(b.a,{sm:7},v.a.createElement(E.a,{type:d,value:r[e.Name],name:e.Name,valid:i[e.Name],invalid:!i[e.Name],id:e.Name,onChange:n,required:e.Required},u),v.a.createElement(O.a,null,o[e.Name])))}return null}));return l}return v.a.createElement("div",null,"Select a drive type to continue")}function z(e){var t=e.key,a=e.id,n=e.label,r=e.changeHandler,i=e.type,o=e.value,s=e.name,c=e.placeholder,l=e.isValid,u=void 0!==l&&l;return v.a.createElement(h.a,{key:t,row:!0},v.a.createElement(g.a,{for:a,sm:5},n),v.a.createElement(b.a,{sm:7},v.a.createElement(E.a,{type:i,value:o,name:s,placeholder:c,id:a,onChange:r,valid:u,invalid:!u,required:!0}),v.a.createElement(O.a,{valid:!0},"Sweet! that name is available"),v.a.createElement(O.a,null,"Sad! That name is already assigned or empty")))}var U=function(e){Object(p.a)(a,e);var t=Object(m.a)(a);function a(e,n){var r;return Object(l.a)(this,a),(r=t.call(this,e,n)).toggle=function(e){var t=e.target.name;r.setState(Object(c.a)({},t,!r.state[t]))},r.handleInputChange=function(e){var t=e.target.name,a=e.target.value,n=r.state.optionTypes[t];r.setState({formValues:Object(s.a)(Object(s.a)({},r.state.formValues),{},Object(c.a)({},t,a))});var i=!0,o="";"SizeSuffix"===n?(i=Object(V.q)(a))||(o="The valid input is size( off | {unit}{metric} eg: 10G, 100M, 10G100M etc.)"):"Duration"===n?(i=Object(V.o)(a))||(o="The valid input is time ({unit}{metric} eg: 10ms, 100m, 10h15ms etc.)"):"int"===n&&((i=Object(V.p)(a))||(o="The valid input is int (100,200,300 etc)")),!r.state.required[t]||a&&""!==a||(i=!1)||(o+=" This field is required"),r.setState((function(e){return{isValid:Object(s.a)(Object(s.a)({},e.isValid),{},Object(c.a)({},t,i)),formErrors:Object(s.a)(Object(s.a)({},e.formErrors),{},Object(c.a)({},t,o))}}))},r.changeDriveType=function(e,t){var a=t.newValue,n=r.props.providers,i=a,o={},s={},c={},l={},u={};if(void 0!==i&&""!==i){var d=Object(V.f)(n,i);void 0!==d&&d.Options.forEach((function(e){var t=e.DefaultStr,a=e.Type,n=e.Name,r=e.Required;0===e.Hide&&(o[n]=t,s[n]=a,u[n]=r,c[n]=!(r&&(!t||""===t)),l[n]="")})),r.setState({drivePrefix:i,formValues:o,optionTypes:s,isValid:c,formErrors:l,required:u})}else r.setState({drivePrefix:i})},r.openSetupDrive=function(e){e&&e.preventDefault(),r.setState({colSetup:!0})},r.editAdvancedOptions=function(e){r.setState({advancedOptions:!r.state.advancedOptions})},r.clearForm=function(e){r.setState({driveName:"",drivePrefix:""})},r.changeName=function(e){var t=r.state.driveNameIsEditable,a=e.target.value;t&&Object(V.n)(a)?r.setState({driveName:a},(function(){void 0===a||""===a?r.setState({driveNameIsValid:!1}):w.a.post(J.a.getConfigForRemote,{name:a}).then((function(e){var t=r.state.formErrors,a=Object(V.j)(e.data);t.driveName=a?"":"Duplicate",r.setState({formErrors:t,driveNameIsValid:a})}))})):r.setState((function(e){return{formErrors:Object(s.a)(Object(s.a)({},e.formErrors),{},{driveName:"Cannot edit name"})}}))},r.openAdvancedSettings=function(e){r.state.advancedOptions?r.setState({colAdvanced:!0}):r.configEndDiv.scrollIntoView({behavior:"smooth"})},r.gotoNextStep=function(){var e=r.state,t=e.currentStepNumber,a=e.advancedOptions;a&&3===t||!a&&2===t?r.handleSubmit(null):r.setCurrentStep(t+1)},r.gotoPrevStep=function(){var e=r.state.currentStepNumber;r.setCurrentStep(e-1)},r.setCurrentStep=function(e){r.setState({currentStepNumber:e})},r.StepShowCase=function(e){var t=e.currentStepNumber,a=["Set up Remote Config","Set up Drive","Advanced Config"];return v.a.createElement(y.a,{className:"timeline"},v.a.createElement(j.a,null,a.map((function(e,n){return n+=1,v.a.createElement(v.a.Fragment,{key:n},v.a.createElement(b.a,{className:"text-center "+(t===n?"step-active":""),md:2,sm:4},v.a.createElement("button",{className:"btn btn-step-count",onClick:function(){return r.setCurrentStep(n)}},n),v.a.createElement("h4",null,e)),n!==a.length&&v.a.createElement(b.a,{md:3,className:"d-none d-md-block"},v.a.createElement("div",{className:"timeline-divider align-middle"})))}))))},r.state={colRconfig:!0,colSetup:!1,colAdvanced:!1,driveName:"",driveNameIsEditable:!0,advancedOptions:!1,formValues:{},formValuesValid:{},required:{},authModalIsVisible:!1,drivePrefix:"",driveNameIsValid:!1,formErrors:{driveName:""},optionTypes:{},isValid:{},currentStepNumber:1},r.configCheckInterval=null,r.handleSubmit=r.handleSubmit.bind(Object(d.a)(r)),r.toggleAuthModal=r.toggleAuthModal.bind(Object(d.a)(r)),r.startAuthentication=r.startAuthentication.bind(Object(d.a)(r)),r.checkConfigStatus=r.checkConfigStatus.bind(Object(d.a)(r)),r}return Object(u.a)(a,[{key:"checkConfigStatus",value:function(){var e=Object(o.a)(i.a.mark((function e(){var t,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.driveName,e.prev=1,e.next=4,w.a.post(J.a.getConfigForRemote,{name:t});case 4:a=e.sent,Object(V.j)(a.data)||(clearInterval(this.configCheckInterval),this.configCheckInterval=null,this.toggleAuthModal(),this.props.history.push("/dashboard")),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),R.b.error("Error creating config. ".concat(e.t0),{autoClose:!1});case 11:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"validateForm",value:function(){var e=this.state,t=e.driveNameIsValid,a=e.drivePrefix,r=e.isValid,i=!0;t||(i=!1),""===a&&(i=!1);for(var o=0,s=Object.entries(r);o<s.length;o++){var c=Object(n.a)(s[o],2),l=c[0],u=c[1];if(!l||!u){i=!1;break}}return i}},{key:"toggleAuthModal",value:function(){this.setState((function(e,t){return{authModalIsVisible:!e.authModalIsVisible}}))}},{key:"startAuthentication",value:function(){this.toggleAuthModal(),null===this.configCheckInterval?this.configCheckInterval=setInterval(this.checkConfigStatus,H.f):console.error("Interval already running. Should not start a new one")}},{key:"stopAuthentication",value:function(){this.setState((function(e,t){return{authModalIsVisible:!1}})),clearInterval(this.configCheckInterval)}},{key:"handleSubmit",value:function(){var e=Object(o.a)(i.a.mark((function e(t){var a,r,o,s,c,l,u,d,p,m,f;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.preventDefault(),a=this.state,r=a.formValues,o=a.drivePrefix,s=this.props.providers,!this.validateForm()){e.next=39;break}if(void 0===o||""===o){e.next=37;break}if(void 0===(c=Object(V.f)(s,o))){e.next=37;break}l=c.Options,u={},d=function(){var e=Object(n.a)(m[p],2),t=e[0],a=e[1];if("token"===t)return u[t]=a,"continue";var r=l.find((function(e,a,n){return t===e.Name}));r&&(a!==r.DefaultStr&&(u[t]=a))},p=0,m=Object.entries(r);case 11:if(!(p<m.length)){e.next=18;break}if("continue"!==d()){e.next=15;break}return e.abrupt("continue",15);case 15:p++,e.next=11;break;case 18:if(f={parameters:u,name:this.state.driveName,type:this.state.drivePrefix},this.startAuthentication(),e.prev=20,this.props.match.params.drivePrefix){e.next=28;break}return e.next=25,w.a.post(J.a.createConfig,f);case 25:R.b.info("Config created"),e.next=31;break;case 28:return e.next=30,w.a.post(J.a.updateConfig,f);case 30:R.b.info("Config Updated");case 31:e.next=37;break;case 33:e.prev=33,e.t0=e.catch(20),R.b.error("Error creating config. ".concat(e.t0),{autoClose:!1}),this.stopAuthentication();case 37:e.next=40;break;case 39:R.b.warn("Check for errors before submitting.",{autoClose:!1});case 40:case"end":return e.stop()}}),e,this,[[20,33]])})));return function(t){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.drivePrefix;(!this.props.providers||this.props.providers.length<1)&&this.props.getProviders(),t&&(this.setState({driveName:t,driveNameIsValid:!0,driveNameIsEditable:!1}),w.a.post(J.a.getConfigForRemote,{name:t}).then((function(t){console.log(t),e.changeDriveType(void 0,{newValue:t.data.type}),e.setState((function(e){return{formValues:Object(s.a)(Object(s.a)({},e.formValues),t.data)}}))})))}},{key:"componentWillUnmount",value:function(){clearInterval(this.configCheckInterval),this.configCheckInterval=null}},{key:"render",value:function(){var e=this,t=this.state,a=t.drivePrefix,n=t.advancedOptions,r=t.driveName,i=t.driveNameIsValid,o=t.currentStepNumber,s=this.props.providers;return v.a.createElement("div",{"data-test":"newDriveComponent"},v.a.createElement("div",null,v.a.createElement("i",{className:"icon-arrow-right"}),v.a.createElement(N.a,{color:"link",onClick:function(){return e.props.history.push("/simplenewdrive")}},"Web3 storage")),v.a.createElement(G.a,null,v.a.createElement("p",null,"This 3 step process will guide you through creating a new config. For auto config, leave the parameters as it is."),v.a.createElement(this.StepShowCase,{currentStepNumber:o}),v.a.createElement(S.a,{isOpen:1===o},v.a.createElement(k.a,null,v.a.createElement(x.a,null,v.a.createElement(z,{label:"Name of this drive (For your reference)",changeHandler:this.changeName,value:r,placeholder:"Enter a name",name:"name",id:"driveName",isValid:i}),v.a.createElement(h.a,{row:!0},v.a.createElement(g.a,{for:"driveType",sm:5},"Select"),v.a.createElement(b.a,{sm:7},v.a.createElement(D,{suggestions:s,value:a,onChange:this.changeDriveType}))),v.a.createElement(h.a,{row:!0},v.a.createElement(b.a,{sm:3},v.a.createElement(g.a,{for:"inputDriveName"},"Docs are available at ")," ",v.a.createElement("a",{href:"https://www.ipfsdrive.com/docs#remotes"},"IPFS drive Config"))),v.a.createElement("div",{className:"clearfix"},v.a.createElement("div",{className:"float-right"},v.a.createElement(N.a,{className:"ml-3 btn-blue",onClick:this.gotoNextStep},"Next")))))),v.a.createElement(S.a,{isOpen:2===o},v.a.createElement(k.a,null,v.a.createElement(x.a,null,v.a.createElement(L,{drivePrefix:a,loadAdvanced:!1,changeHandler:this.handleInputChange,errorsMap:this.state.formErrors,isValidMap:this.state.isValid,currentValues:this.state.formValues,config:s}),v.a.createElement("div",{className:"clearfix"},v.a.createElement("div",{className:"float-right"},v.a.createElement(E.a,{type:"checkbox",value:n,onChange:this.editAdvancedOptions}),v.a.createElement("span",{className:"mr-3"},"Edit Advanced Options"),v.a.createElement(N.a,{className:"btn-no-background",onClick:this.gotoPrevStep},"Go back"),v.a.createElement(N.a,{className:"ml-3 btn-blue",onClick:this.gotoNextStep},"Next")))))),v.a.createElement(S.a,{isOpen:3===o},v.a.createElement(k.a,null,v.a.createElement(x.a,null,v.a.createElement(L,{drivePrefix:a,loadAdvanced:!0,changeHandler:this.handleInputChange,errorsMap:this.state.formErrors,isValidMap:this.state.isValid,currentValues:this.state.formValues,config:s}),v.a.createElement("div",{className:"clearfix"},v.a.createElement("div",{className:"float-right"},v.a.createElement(E.a,{type:"checkbox",value:n,onChange:this.editAdvancedOptions}),v.a.createElement("span",{className:"mr-3"},"Edit Advanced Options"),v.a.createElement(N.a,{className:"btn-no-background",onClick:this.gotoPrevStep},"Go back"),v.a.createElement(N.a,{className:"ml-3 btn-blue",onClick:this.gotoNextStep},"Next")))))),v.a.createElement(C.a,{isVisible:this.state.authModalIsVisible,closeModal:this.toggleAuthModal})))}}]),a}(v.a.Component);U.defaultProps={isEdit:!1};t.default=Object(F.b)((function(e){return{providers:e.config.providers}}),{getProviders:q.b})(U)}}]);
//# sourceMappingURL=18.5b1387cf.chunk.js.map